{% extends "admin/base.html" %}

{% block content %}

<div class = "ui container">

    {% if datasets | length == 0 %}

        <div class="ui info icon message">
            <i class="exclamation icon"></i>
            <div class="content">
            <div class="header">
                No datasets
            </div>
            <p>Add datasets</p>
            </div>
        </div>

    {% endif %}

    <!-- Dataset uploading form -->

    <h4 class="ui horizontal divider header">
        Dataset Information
    </h4>
    <form action="" class="ui form" method = "POST">
        
        <div class="field">
          <label>Name</label>
            <div class="field">
                <input type="text" name="dataset_name" placeholder="Dataset Name">
            </div>
        </div>

        <div class="field">
            <label>Description</label>
            <div class="field">
                <textarea name="dataset_desc" placeholder="Enter the description of the dataset"></textarea>
            </div>
        </div>

        <div class="field">
            <div class="field">
                <input type="file" name="zipfile">
            </div>
        </div>

        <div class="ui button primary">Upload Dataset</div>
    </form>
    
    <!-- Availabe datasets -->
    {% if datasets | length > 0 %}

        <h4 class="ui horizontal divider header">
            Available Dataset
        </h4>
        <table class="ui compact celled table">
            <thead>
                <tr>
                <th class="twelve wide">Dataset</th>
                <th class="four wide">File Count</th>
                </tr>
            </thead>
            <tbody>
                <!-- Render the dataset -->
                <!-- id, name, description , file_count, total: sql fields -->
                {% for data in datasets %}
                    <tr>
                        <td><a href="{{ url_for('admin.dataset_with_id', dset_id=data['id']) }}">{{ data['name'] }}</a></td>
                        <td>{{ data['file_count'] }}</td>
                    </tr>
                {% endfor %}

            </tbody>
            <tfoot class="full-width">
                <tr>
                <th colspan="4">
                    <!-- Render pagination for other datasets -->
                    <div class="ui right floated pagination menu">
                        {% if page > 0 %}
                            <!-- Calculate the prev page and use as a link -->
                            {% set link = page-1 %}
                            <a href="{{ url_for('admin.all_datasets', page=link) }}" class="active item">Prev</a>
                        {% endif %}

                        <!-- Page*limit must be less than total no. of datasets -->
                        {% if page*20 < total %}
                            <!-- Calculate the next page and use as a link -->
                            {% set link = page+1 %}
                            <a href="{{ url_for('admin.all_datasets', page=link) }}" class="item">Next</a>
                        {% endif %}
                    </div>
                </th>
                </tr>
            </tfoot>
        </table>
    {% endif %}

</div>
{% endblock %}